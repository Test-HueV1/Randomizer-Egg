-- Simple GUI Menu Example + ESP Egg Preview
-- Place this LocalScript inside StarterGui

local Player = game.Players.LocalPlayer
local PlayerGui = Player:WaitForChild("PlayerGui")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

-- Change if your eggs are in another folder
local EggFolder = Workspace:WaitForChild("GardenEggs")

-- Clear old GUIs (if respawned)
if PlayerGui:FindFirstChild("CustomMenu") then
	PlayerGui.CustomMenu:Destroy()
end

local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local ToggleButton = Instance.new("TextButton")
local Title = Instance.new("TextLabel")
local NotificationFrame = Instance.new("Frame")
local NotificationLabel = Instance.new("TextLabel")

-- ScreenGui setup
ScreenGui.Name = "CustomMenu"
ScreenGui.ResetOnSpawn = false -- keep GUI when respawning
ScreenGui.Parent = PlayerGui

-- Menu Frame
Frame.Parent = ScreenGui
Frame.BackgroundColor3 = Color3.fromRGB(150, 0, 0)
Frame.Position = UDim2.new(0.05, 0, 0.2, 0)
Frame.Size = UDim2.new(0, 200, 0, 300)
Frame.Visible = true -- default visible

-- Title at the top
Title.Parent = Frame
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
Title.Text = "Randomizer Egg"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 20

-- Toggle Button (top-left corner of screen)
ToggleButton.Parent = ScreenGui
ToggleButton.Size = UDim2.new(0, 80, 0, 40)
ToggleButton.Position = UDim2.new(0, 10, 0, 10)
ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
ToggleButton.Text = "Menu"
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.Font = Enum.Font.SourceSansBold
ToggleButton.TextSize = 18

-- Toggle functionality
ToggleButton.MouseButton1Click:Connect(function()
	Frame.Visible = not Frame.Visible
end)

-- Notification Frame (bottom-right corner)
NotificationFrame.Parent = ScreenGui
NotificationFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
NotificationFrame.BackgroundTransparency = 0.3
NotificationFrame.Size = UDim2.new(0, 250, 0, 50)
NotificationFrame.Position = UDim2.new(1, -260, 1, -60)
NotificationFrame.Visible = false

NotificationLabel.Parent = NotificationFrame
NotificationLabel.Size = UDim2.new(1, -10, 1, -10)
NotificationLabel.Position = UDim2.new(0, 5, 0, 5)
NotificationLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
NotificationLabel.Font = Enum.Font.SourceSansBold
NotificationLabel.TextSize = 18
NotificationLabel.Text = ""

-- Notification function
local function showNotification(message)
	NotificationLabel.Text = message
	NotificationFrame.Visible = true

	-- Hide after 2 seconds
	task.delay(2, function()
		NotificationFrame.Visible = false
	end)
end

-- Function to create toggle buttons inside menu
local function createButton(name, text, order, callback)
	local btn = Instance.new("TextButton")
	btn.Name = name
	btn.Parent = Frame
	btn.BackgroundColor3 = Color3.fromRGB(200, 0, 0) -- default red
	btn.Size = UDim2.new(1, -10, 0, 40)
	btn.Position = UDim2.new(0, 5, 0, 45 + (order * 45))
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.SourceSansBold
	btn.TextSize = 18
	btn.Text = text

	local toggled = false
	btn.MouseButton1Click:Connect(function()
		toggled = not toggled
		if toggled then
			btn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
		else
			btn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
		end

		callback(btn, toggled)
		showNotification(text .. (toggled and " ON" or " OFF"))
	end)

	return btn
end

-- ESP System for Eggs
local function clearESP()
	for _, v in pairs(EggFolder:GetChildren()) do
		if v:FindFirstChild("PetESP") then
			v.PetESP:Destroy()
		end
	end
end

local function createESP(egg, petName)
	if egg:FindFirstChild("PetESP") then return end

	local billboard = Instance.new("BillboardGui")
	billboard.Name = "PetESP"
	billboard.Adornee = egg:FindFirstChildWhichIsA("BasePart") or egg
	billboard.Size = UDim2.new(0, 100, 0, 40)
	billboard.StudsOffset = Vector3.new(0, 3, 0)
	billboard.AlwaysOnTop = true

	local textLabel = Instance.new("TextLabel", billboard)
	textLabel.Size = UDim2.new(1, 0, 1, 0)
	textLabel.BackgroundTransparency = 1
	textLabel.Text = petName
	textLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
	textLabel.TextStrokeTransparency = 0.5
	textLabel.TextScaled = true

	billboard.Parent = egg
end

-- ESP toggle
local espOn = false
createButton("ESP", "ESP: OFF", 0, function(btn, state)
	espOn = state
	btn.Text = "ESP: " .. (espOn and "ON ✅" or "OFF ❌")
	print("ESP Toggled:", espOn)

	if not espOn then
		clearESP()
	end
end)

-- Run loop to update ESP
RunService.RenderStepped:Connect(function()
	if espOn then
		for _, egg in pairs(EggFolder:GetChildren()) do
			-- Example: egg has a StringValue called "PetType"
			local petInfo = egg:FindFirstChild("PetType")
			if petInfo then
				createESP(egg, petInfo.Value)
			end
		end
	end
end)

-- Randomize Egg
createButton("RandomEgg", "Randomize Egg", 1, function(_, state)
	print("Egg randomized!")
end)

-- Auto Age (click = +1 Age with 5s cooldown)
local ageCooldown = false
createButton("AutoAge", "Add +1 Age", 2, function(_, state)
	if ageCooldown then
		showNotification("⏳ Wait 5s before aging again!")
		return
	end

	ageCooldown = true
	print("Age +1 clicked!")

	local character = Player.Character
	if character then
		local pet = character:FindFirstChild("Pet") 
		if pet and pet:FindFirstChild("BillboardGui") then
			local label = pet.BillboardGui:FindFirstChildWhichIsA("TextLabel")
			if label then
				local text = label.Text
				local age = tonumber(string.match(text, "Age%s+(%d+)")) or 0
				age += 1
				label.Text = "Bear Bee\n[4.22 KG]\n[Age " .. age .. "]"
			end
		end
	end

	-- Reset cooldown after 5s
	task.delay(5, function()
		ageCooldown = false
	end)
end)

-- Mutation Reroll
createButton("MutReroll", "Mutation Reroll", 3, function(_, state)
	print("Mutation reroll clicked!")
end)

-- Toggle Mutation
createButton("ToggleMut", "Toggle Mutation", 4, function(_, state)
	print("Mutation toggled!")
end)

-- ✅ Duplicate Item button
createButton("DuplicateItem", "Duplicate Item", 5, function(_, state)
	local character = Player.Character
	if character then
		local pet = character:FindFirstChild("Pet")
		if pet then
			local clone = pet:Clone()
			clone.Parent = Workspace -- puts duplicate in Workspace
			clone.Name = pet.Name .. "_Copy"
			clone:SetPrimaryPartCFrame(pet.PrimaryPart.CFrame * CFrame.new(3,0,0)) -- spawn beside
			showNotification("✨ Pet duplicated successfully!")
			print("Pet duplicated:", clone.Name)
		else
			showNotification("❌ No Pet found to duplicate!")
		end
	end
end)
